var ae=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var Y=(e,s,o)=>s in e?ae(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,B=(e,s)=>{for(var o in s||(s={}))de.call(s,o)&&Y(e,o,s[o]);if(H)for(var o of H(s))ce.call(s,o)&&Y(e,o,s[o]);return e},Z=(e,s)=>re(e,ie(s));var C=(e,s,o)=>new Promise((P,f)=>{var g=n=>{try{r(o.next(n))}catch(m){f(m)}},d=n=>{try{r(o.throw(n))}catch(m){f(m)}},r=n=>n.done?P(n.value):Promise.resolve(n.value).then(g,d);r((o=o.apply(e,s)).next())});import{h as u,bd as W,aY as J,de as fe,bc as ee,df as K,bb as pe,d as _e,r as j,b as me,v as N,b2 as ge,bi as be,dg as ye,s as ve,M as A,o as c,O as y,w as a,i as O,c as G,I as Q,H as L,x as X,bg as R,j as h,t as D,y as I,bp as Be,bq as ke,N as Oe,aZ as Pe,dh as Fe,m as we,di as Se,n as Ce,bn as je,z as x,aj as Ne,a_ as Ve,l as Me,b0 as he,dj as De,dk as Ee,k as Ue}from"./index.8bb9f8e1.js";import{s as ze,p as $}from"./propTypes.5abfbe49.js";import{D as Re}from"./DownOutlined.c246ed4b.js";import{U as Ie}from"./UpOutlined.36e7ee99.js";import{Q as Te}from"./QuestionCircleOutlined.7eff4913.js";function $e(e){return e==="NInput"?"\u8BF7\u8F93\u5165":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"\u8BF7\u9009\u62E9":""}function Ae({emit:e,getProps:s,formModel:o,getSchema:P,formElRef:f,defaultFormModel:g,loadingSub:d,handleFormValues:r}){function n(){return C(this,null,function*(){var l;return(l=u(f))==null?void 0:l.validate()})}function m(l){return C(this,null,function*(){l&&l.preventDefault(),d.value=!0;const{submitFunc:b}=u(s);if(b&&W(b))return yield b(),d.value=!1,!1;if(!u(f))return!1;try{yield n();const p=V();return d.value=!1,e("submit",p),p}catch(p){return e("submit",!1),d.value=!1,console.error(p),!1}})}function F(){return C(this,null,function*(){var l;yield(l=u(f))==null?void 0:l.restoreValidation()})}function E(){return C(this,null,function*(){const{resetFunc:l,submitOnReset:b}=u(s);if(l&&W(l)&&(yield l()),!u(f))return;Object.keys(o).forEach(M=>{o[M]=u(g)[M]||null}),yield F();const p=r(J(u(o)));e("reset",p),b&&(yield m())})}function V(){return u(f)?r(J(u(o))):{}}function U(l){return C(this,null,function*(){const b=u(P).map(v=>v.field).filter(Boolean);Object.keys(l).forEach(v=>{const p=l[v];b.includes(v)&&(o[v]=p)})})}function k(l){d.value=l}return{handleSubmit:m,validate:n,resetFields:E,getFieldsValue:V,clearValidate:F,setFieldsValue:U,setLoading:k}}function Ge({defaultFormModel:e,getSchema:s,formModel:o}){function P(g){if(!fe(g))return{};const d={};for(const r of Object.entries(g)){let[,n]=r;const[m]=r;!m||ee(n)&&n.length===0||W(n)||K(n)||(pe(n)&&(n=n.trim()),ze(d,m,n))}return d}function f(){const g=u(s),d={};g.forEach(r=>{const{defaultValue:n}=r;K(n)||(d[r.field]=n,o[r.field]=n)}),e.value=d}return{handleFormValues:P,initDefault:f}}const Qe={labelWidth:{type:[Number,String],default:80},schemas:{type:[Array],default:()=>[]},layout:{type:String,default:"inline"},inline:{type:Boolean,default:!1},size:{type:String,default:"medium"},labelPlacement:{type:String,default:"left"},isFull:{type:Boolean,default:!0},showActionButtonGroup:$.bool.def(!0),showResetButton:$.bool.def(!0),resetButtonOptions:Object,showSubmitButton:$.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:$.bool.def(!0),submitButtonText:{type:String,default:"\u67E5\u8BE2"},resetButtonText:{type:String,default:"\u91CD\u7F6E"},gridProps:Object,giProps:Object,baseGridStyle:{type:Object},collapsed:{type:Boolean,default:!1},collapsedRows:{type:Number,default:1}},Le=_e({name:"BasicForm",components:{DownOutlined:Re,UpOutlined:Ie,QuestionCircleOutlined:Te},props:B({},Qe),emits:["reset","submit","register"],setup(e,{emit:s,attrs:o}){const P=j({}),f=me({}),g=j({}),d=j(null),r=j(null),n=j(!0),m=j(!1),F=j(!1),E=N(()=>Object.assign({size:e.size,type:"primary"},e.submitButtonOptions)),V=N(()=>Object.assign({size:e.size,type:"default"},e.resetButtonOptions));function U(i){var S;const w=(S=i.componentProps)!=null?S:{},z=i.component;return B({clearable:!0,placeholder:$e(u(z))},w)}const k=N(()=>{const i=B(B({},e),u(g)),w={rules:{}};return(i.schemas||[]).forEach(S=>{S.rules&&ee(S.rules)&&(w.rules[S.field]=S.rules)}),B(B({},i),u(w))}),l=N(()=>{const{layout:i}=u(k);return i==="inline"}),b=N(()=>{const{gridProps:i}=u(k);return Z(B({},i),{collapsed:l.value?n.value:!1,responsive:"screen"})}),v=N(()=>B(B(B({},o),e),u(k))),p=N(()=>{const i=u(d)||u(k).schemas;for(const w of i){const{defaultValue:z}=w;z&&(w.defaultValue=z)}return i}),{handleFormValues:M,initDefault:T}=Ge({defaultFormModel:P,getSchema:p,formModel:f}),{handleSubmit:t,validate:_,resetFields:q,getFieldsValue:te,clearValidate:ne,setFieldsValue:oe}=Ae({emit:s,getProps:k,formModel:f,getSchema:p,formElRef:r,defaultFormModel:P,loadingSub:m,handleFormValues:M});function le(){n.value=!n.value}function se(i){return C(this,null,function*(){g.value=ye(u(g)||{},i)})}const ue={getFieldsValue:te,setFieldsValue:oe,resetFields:q,validate:_,clearValidate:ne,setProps:se,submit:t};return ge(()=>p.value,i=>{u(F)||i!=null&&i.length&&(T(),F.value=!0)}),be(()=>{T(),s("register",ue)}),{formElRef:r,formModel:f,getGrid:b,getProps:k,getBindValue:v,getSchema:p,getSubmitBtnOptions:E,getResetBtnOptions:V,handleSubmit:t,resetFields:q,loadingSub:m,isInline:l,getComponentProps:U,unfoldToggle:le}}});function We(e,s,o,P,f,g){const d=A("QuestionCircleOutlined"),r=Oe,n=Ve,m=Me,F=Pe,E=he,V=De,U=Ee,k=Ue,l=Fe,b=we,v=A("DownOutlined"),p=A("UpOutlined"),M=Se,T=Ce;return c(),y(T,R(e.getBindValue,{model:e.formModel,ref:"formElRef"}),{default:a(()=>[O(M,Be(ke(e.getGrid)),{default:a(()=>[(c(!0),G(L,null,Q(e.getSchema,t=>(c(),y(l,R(t.giProps,{key:t.field}),{default:a(()=>[O(k,{label:t.label,path:t.field},je({default:a(()=>[t.slot?x(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):t.component==="NCheckbox"?(c(),y(E,{key:1,value:e.formModel[t.field],"onUpdate:value":_=>e.formModel[t.field]=_},{default:a(()=>[O(F,null,{default:a(()=>[(c(!0),G(L,null,Q(t.componentProps.options,_=>(c(),y(m,{key:_.value,value:_.value,label:_.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioGroup"?(c(),y(U,{key:2,value:e.formModel[t.field],"onUpdate:value":_=>e.formModel[t.field]=_},{default:a(()=>[O(F,null,{default:a(()=>[(c(!0),G(L,null,Q(t.componentProps.options,_=>(c(),y(V,{key:_.value,value:_.value},{default:a(()=>[h(D(_.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):(c(),y(Ne(t.component),R({key:3},e.getComponentProps(t),{value:e.formModel[t.field],"onUpdate:value":_=>e.formModel[t.field]=_,class:{isFull:t.isFull!=!1&&e.getProps.isFull}}),null,16,["value","onUpdate:value","class"])),t.suffix?x(e.$slots,t.suffix,{key:4,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):I("",!0)]),_:2},[t.labelMessage?{name:"label",fn:a(()=>[h(D(t.label)+" ",1),O(n,{trigger:"hover",style:X(t.labelMessageStyle)},{trigger:a(()=>[O(r,{size:"18",class:"text-gray-400 cursor-pointer"},{default:a(()=>[O(d)]),_:1})]),default:a(()=>[h(" "+D(t.labelMessage),1)]),_:2},1032,["style"])]),key:"0"}:void 0]),1032,["label","path"])]),_:2},1040))),128)),e.getProps.showActionButtonGroup?(c(),y(l,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:a(({overflow:t})=>[O(F,{align:"center",justify:e.isInline?"end":"start",style:X({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`})},{default:a(()=>[e.getProps.showSubmitButton?(c(),y(b,R({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit,loading:e.loadingSub}),{default:a(()=>[h(D(e.getProps.submitButtonText),1)]),_:1},16,["onClick","loading"])):I("",!0),e.getProps.showResetButton?(c(),y(b,R({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:a(()=>[h(D(e.getProps.resetButtonText),1)]),_:1},16,["onClick"])):I("",!0),e.isInline&&e.getProps.showAdvancedButton?(c(),y(b,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:a(()=>[t?(c(),y(r,{key:0,size:"14",class:"unfold-icon"},{default:a(()=>[O(v)]),_:1})):(c(),y(r,{key:1,size:"14",class:"unfold-icon"},{default:a(()=>[O(p)]),_:1}))]),default:a(()=>[h(" "+D(t?"\u5C55\u5F00":"\u6536\u8D77"),1)]),_:2},1032,["onClick"])):I("",!0)]),_:2},1032,["justify","style"])]),_:1},8,["span","suffix"])):I("",!0)]),_:3},16)]),_:3},16,["model"])}const Xe=ve(Le,[["render",We],["__scopeId","data-v-fd343dc0"]]);export{Xe as B};
